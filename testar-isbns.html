<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de ISBNs</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .resultado { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .sucesso { border-left: 4px solid #4caf50; }
        .erro { border-left: 4px solid #f44336; }
        h3 { margin: 0 0 10px 0; }
        .dados { font-size: 12px; color: #666; }
        button { background: #2196F3; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background: #1976D2; }
        .loading { color: #ff9800; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üîç Teste de Busca de ISBNs</h1>
    <button onclick="testarTodos()">Testar Todos os ISBNs</button>
    <div id="resultados"></div>

    <script>
        const isbns = [
            '9786589678564',
            '9786558884101',
            '9788502634787',
            '9788577344857',
            '9788500032035',
            '9788554309022',
            '9786589077039'
        ];

        async function testarISBN(isbn) {
            const resultadosDiv = document.getElementById('resultados');
            const div = document.createElement('div');
            div.className = 'resultado';
            div.innerHTML = `<h3>ISBN: ${isbn}</h3><div class="loading">Buscando...</div>`;
            resultadosDiv.appendChild(div);

            const urls = [
                `https://www.googleapis.com/books/v1/volumes?q=isbn:${isbn}`,
                `https://openlibrary.org/api/books?bibkeys=ISBN:${isbn}&format=json&jscmd=data`,
                `https://openlibrary.org/search.json?isbn=${isbn}`
            ];

            let encontrado = false;
            let detalhes = '';

            for (let i = 0; i < urls.length; i++) {
                try {
                    console.log(`Testando URL ${i + 1}: ${urls[i]}`);
                    const response = await fetch(urls[i]);
                    const data = await response.json();
                    
                    console.log(`Resposta da URL ${i + 1}:`, data);

                    // Google Books
                    if (i === 0 && data.totalItems > 0) {
                        const livro = data.items[0].volumeInfo;
                        encontrado = true;
                        detalhes = `
                            <strong>‚úÖ Encontrado no Google Books!</strong><br>
                            üìñ T√≠tulo: ${livro.title || 'N/A'}<br>
                            ‚úçÔ∏è Autor: ${livro.authors?.join(', ') || 'N/A'}<br>
                            üè¢ Editora: ${livro.publisher || 'N/A'}<br>
                            üìÖ Ano: ${livro.publishedDate || 'N/A'}<br>
                            üìä Total de resultados: ${data.totalItems}
                        `;
                        break;
                    }
                    
                    // Open Library (formato 1)
                    if (i === 1 && data[`ISBN:${isbn}`]) {
                        const livro = data[`ISBN:${isbn}`];
                        encontrado = true;
                        detalhes = `
                            <strong>‚úÖ Encontrado no Open Library!</strong><br>
                            üìñ T√≠tulo: ${livro.title || 'N/A'}<br>
                            ‚úçÔ∏è Autor: ${livro.authors?.map(a => a.name).join(', ') || 'N/A'}<br>
                            üè¢ Editora: ${livro.publishers?.map(p => p.name).join(', ') || 'N/A'}<br>
                            üìÖ Ano: ${livro.publish_date || 'N/A'}
                        `;
                        break;
                    }
                    
                    // Open Library (formato 2)
                    if (i === 2 && data.docs && data.docs.length > 0) {
                        const livro = data.docs[0];
                        encontrado = true;
                        detalhes = `
                            <strong>‚úÖ Encontrado no Open Library (search)!</strong><br>
                            üìñ T√≠tulo: ${livro.title || 'N/A'}<br>
                            ‚úçÔ∏è Autor: ${livro.author_name?.join(', ') || 'N/A'}<br>
                            üè¢ Editora: ${livro.publisher?.join(', ') || 'N/A'}<br>
                            üìÖ Ano: ${livro.first_publish_year || 'N/A'}<br>
                            üìä Total de resultados: ${data.numFound}
                        `;
                        break;
                    }
                } catch (error) {
                    console.error(`Erro na URL ${i + 1}:`, error);
                }
            }

            if (encontrado) {
                div.className = 'resultado sucesso';
                div.innerHTML = `<h3>ISBN: ${isbn}</h3><div class="dados">${detalhes}</div>`;
            } else {
                div.className = 'resultado erro';
                div.innerHTML = `
                    <h3>ISBN: ${isbn}</h3>
                    <div class="dados">
                        <strong>‚ùå N√£o encontrado em nenhuma fonte</strong><br>
                        Tentado: Google Books, Open Library (2 APIs)
                    </div>
                `;
            }
        }

        async function testarTodos() {
            document.getElementById('resultados').innerHTML = '';
            for (const isbn of isbns) {
                await testarISBN(isbn);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
        }

        // Teste autom√°tico ao carregar
        window.onload = () => {
            setTimeout(testarTodos, 1000);
        };
    </script>
</body>
</html>
